{%extends "template.html" %}
{%load static%}

{%block body%}
<div class="shop-container-root">
    <span style="display: flex; align-content: space-between; align-items: flex-start">
        <h3 id="shop-list-title">Items In Stock</h3>
        <button class="stock-detail" id="remove-stock-btn" onclick="document.location='/pharmacy'">Back to Pharmacy</button>
    </span>
    <div class="shop-list-container">
        {%for item in items%}
        <div id="{{item.id}}" class="stock-item-container">
            <span style="display: flex; flex-direction: row; justify-content: flex-end; align-content: center">
                <button class="stock-detail" onclick="removeStock({{item.id}})">X</button>
            </span>
            <label class="stock-detail-label">Item: </label>
            <input class="stock-detail" id="{{item.id}}_name" type="text" value="{{item.name}}" readonly><br>
            <label class="stock-detail-label">Price: </label>
            <span class="stock-detail" tabindex="0"><span class="stock-price">&#8377;</span> <input tabindex="-1" class="stock-price" id="age" type="text" value="{{item.price}}" pattern="[0-9]+" readonly></span><br>
            <label class="stock-detail-label">Quantity:</label>
            <label>{{item.quantity}}</label><br>
        </div>
        {%endfor%}
    </div>
</div>
{%endblock%}


{%block script%}
<script>
    function removeStock(id) {
      console.log("item id: " + id);
        var name = $('#' + id + '_name').val();
        
        $.ajax({
            url : '/pharmacy/remove_stock',
            data : {
                'product_id' : id
              },
            type : 'GET',
            success : function() {
                alert("Removed " + name + " From Stock");
                location.reload();
            },
            error : function(error) {
                alert("Error " + error + " : Unable To Remove From Stock");
                location.reload();
            }
        });
    }
</script>
{%endblock%}
