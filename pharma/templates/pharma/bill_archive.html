{%extends 'template.html'%}

{%block body%}
<div class="shop-container-root">
    <span style="display: flex; align-content: space-between; align-items: flex-start">
        <h3 id="shop-list-title">Bill Archive</h3><br>
        <button class="stock-detail" id="remove-stock-btn" onclick="document.location='{% url 'pharma:shop' %}'">Back to Pharmacy</button>
    </span>
    <div class="shop-list-container">
        {%for bill in bills%}
        <div id="{{item.id}}" class="stock-item-container">
            <label class="stock-detail-label">Bill ID: {{bill.id}}</label>
            <label class="stock-detail-label">Date: </label>
            <input class="stock-detail" id="{{bill.id}}_date" type="text" value="{{bill.date.date}}" readonly><br>
            <label class="stock-detail-label">Buyer Name: </label>
            <input class="stock-detail" id="{{bill.id}}_name" type="text" value="{{bill.name}}" readonly><br>
            <label class="stock-detail-label">Buyer Ph.: </label>
            <input class="stock-detail" id="{{bill.id}}_name" type="text" value="{{bill.contact_num}}" readonly><br>
            <label class="stock-detail-label">Medicines: </label>
            <span class="stock-detail" style="overflow: scroll; height: 10vh;">
            {% for medicine in bill.billunit_set.all %}
                <input class="stock-detail" id="{{bill.id}}_{{medicine.id}}" type="text" value="{{forloop.counter}}. {{medicine.name}}" style="background-color: white; color: black;" readonly>
            {%endfor%}
            </span>
            <button class="stock-detail" onclick="viewBill({{bill.id}})">View Bill</button>
        </div>
        {%endfor%}
    </div>
</div>
{%endblock%}

{%block script%}
<script>
    function viewBill(billId) {
        $.ajax({
            url: "{% url 'pharma:bill_archive_viewer' %}",
            data: {
                'id': billId
            },
            success: function() {
                location="{% url 'pharma:bill_archive_viewer' %}?id=" + billId;
            },
            error: function() {
                alert("unable to view bill");
            }
        });
    }
</script>
{%endblock%}