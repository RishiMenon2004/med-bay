{% extends  'template.html' %}
{% block body %}
<div class="root-container">
    <div class="list-container">
        <div class="container" style="font-size: 2.5vh;">
            <span>
                <b>Profit and Loss</b><br>
                <span style="font-size: 4vh;">Net Profit: &#8377;<label id="expense-label">80000</label></span>
            </span>
            <div>
                <span style="font-size: 4vh;">+ &#8377;<label id="profit-label"></label></span><br>
                <div id="income" class="bar-graph-container">
                    <span id="slice-1" title="100000" class="bar-graph-slice tooltip" data-text="&#8377; 100000">&#8377; 100000</span>
                    <span></span>
                </div>
                <span style="font-size: 4vh;">- &#8377;<label id="loss-label"></label></span>
                <div id="expense" class="bar-graph-container">
                    <span id="slice-2" title="20000" class="bar-graph-slice tooltip" data-text="&#8377; 20000">&#8377; 20000</span>
                    <span></span>
                </div>
            </div> 
        </div>
        <div class="container" style="font-size: 2.5vh;">
            <span>
                <b>Expenses</b><br>
                <span style="font-size: 4vh;">&#8377;<label id="expense-label"></label></span>
                <div id="expenses" class="bar-graph-container">
                    <span id="slice-1" class="bar-graph-slice tooltip" data-text="&#8377; 2000">30%</span>
                    <span id="slice-2" class="bar-graph-slice tooltip" data-text="&#8377; 3000">20%</span>
                    <span id="slice-3" class="bar-graph-slice tooltip" data-text="&#8377; 1000">15%</span>
                    <span id="slice-4" class="bar-graph-slice tooltip" data-text="&#8377; 2000">25%</span>
                    <span id="slice-5" class="bar-graph-slice tooltip" data-text="&#8377; 2000">10%</span>
                </div>
            </span>
            <div>
                <table>
                    <tr>
                        <th>
                            <div style="background-color: #5FBFF9; height: 2vh; width: 2vh; border: 2px black solid; font-size: 0"> </div>
                        </th>
                        <td>
                            Pharmacy Stocks
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <div style="background-color: #3B3B58; height: 2vh; width: 2vh; border: 2px black solid; font-size: 0"> </div>
                        </th>
                        <td>
                            Staff Salary
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <div style="background-color: #478978; height: 2vh; width: 2vh; border: 2px black solid; font-size: 0"> </div>
                        </th>
                        <td>
                            Medical Equipment
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <div style="background-color: #F9DB6D; height: 2vh; width: 2vh; border: 2px black solid; font-size: 0"> </div>
                        </th>
                        <td>
                            Lab Tools
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <div style="background-color: #88B7B5; height: 2vh; width: 2vh; border: 2px black solid; font-size: 0"> </div>
                        </th>
                        <td>
                            Other Resources
                        </td>
                    </tr>
                </table>
            </div> 
        </div>
    </div>
</div>
{%endblock%}

{% block script %}
<script>
function getRandomColor() {
    var letters = '0123456789ABCDEF';
    var color = '#';
    for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
    }
    return color;
}

$(document).ready(function (){

    expensesGraph();
    profitAndLossGraph();

    function profitAndLossGraph() {
        var income = 100000;
        var expense = 20000;
        var barSliceWidth = ""
        var total = income + expense;

        var incomeSliceWidth = (income/total)*100;
        var expenseSliceWidth = (expense/total)*100;
        incomeBarSliceWidth = incomeSliceWidth + "% " + expenseSliceWidth + "%";
        lossBarSliceWidth = incomeSliceWidth + "% " + expenseSliceWidth + "%";

        var barGraph = $("#income");
        barGraph.css('gridTemplateColumns', incomeBarSliceWidth);

        barGraph.children().first().css({
            'borderRadius': "8px 0 0 8px",
            'backgroundColor': '#76f05b',
        });
        barGraph.children().last().css({
            'borderRadius': "0 8px 8px 0",
            'backgroundColor': 'rgba(118,240,91,0.5)'
        });

        var barGraph = $("#expense");
        barGraph.css('gridTemplateColumns', lossBarSliceWidth);

        barGraph.children().first().css({
            'borderRadius': "8px 0 0 8px",
            'backgroundColor': '#ff4040'
        });

        barGraph.children().last().css({
            'borderRadius': "0 8px 8px 0",
            'backgroundColor': 'rgba(255,64,64,0.5)',
        });
    }

    function expensesGraph() {
        var expenses = [3000, 2000, 1500, 2500, 1000];
        var colours = ["#5FBFF9", "#3B3B58", "#478978", "#F9DB6D", "#88B7B5"]
        var barSliceWidth = "";
        var totalExpense = 0;

        for (var expense in expenses) {
            totalExpense += expenses[expense];
        }

        for(var slicePercent in expenses) {
            var sliceWidth = (expenses[slicePercent]/totalExpense)*100;
            barSliceWidth += sliceWidth + "% "
        }

        var barGraph = $("#expenses");
        barGraph.css('gridTemplateColumns', barSliceWidth);

        barGraph.children().first().css('borderRadius', "8px 0 0 8px");
        barGraph.children().last().css('borderRadius', "0 8px 8px 0");

        var i = 0;

        barGraph.children().each(function (index, element) {

            $(element).css({
                'backgroundColor': colours[i]
            });

            if (i == colours.length ) {
                i = 0;
            } else {
                i++;
            }

        });
    }

});
</script>
{%endblock%}